This README provides a detailed overview of how the ToxinKeyMatch.py script works, the inputs and outputs, and instructions for execution.

# **ToxinKeyMatch Module**

## **Description**

The **ToxinKeyMatch** module is the second step in the FiltDeTox pipeline. This module enhances toxin identification by applying additional filtering criteria, specifically matching sequences with toxin-related keywords and Pfam domains associated with toxins.

The **ToxinKeyMatch.py** script takes the combined output from the **TransDeTox** module and adds two new columns:

1. **`toxin_keywords`**: Identifies whether the sequence contains any general toxin-related keywords.
2. **`pfam_ToxinKeywords`**: Identifies whether the sequence matches any toxin-related Pfam domains.

The final output includes the original data from **TransDeTox** along with these two new columns, helping to refine the list of toxin candidates.

---

## **How the Script Works**

### 1. **Input Files**

- **`combined_output.tsv`**: The output from the TransDeTox module. This file contains sequence alignments and DeTox results.
  
- **`toxins_keywords.csv`**: A CSV file containing general toxin-related keywords. These keywords are manually curated from descriptions of known toxins and related sequences in databases like UniProt. The file should contain a list of keywords in the first column.

- **`ToxProt_domain_Keywords.tsv`**: A TSV file containing Pfam domain keywords specifically associated with toxins and venom-related proteins. This file is generated by the **Extract_ToxProtDomain.py** script and contains Pfam domains relevant to toxins.

### 2. **Workflow**

The script performs the following steps:

#### **Step 1: Load Keywords**

- **`load_keywords(file_path)`**: This function reads the keyword file (either **toxins_keywords.csv** or **ToxProt_domain_Keywords.tsv**) and loads the keywords into a Python `set`. The keywords are converted to lowercase for case-insensitive matching.

#### **Step 2: Check for Keywords**

- **`check_keywords(row, keywords)`**: This function checks if any of the keywords from **toxins_keywords.csv** appear in any of the columns of a row (sequence data) as a whole word. It returns `TRUE` if a match is found and `FALSE` otherwise.

- **`check_pfam_domains(row, keywords)`**: This function checks if any of the Pfam domain keywords from **ToxProt_domain_Keywords.tsv** are present in the `pfam domains` column of the sequence data. Like `check_keywords`, it returns `TRUE` if a match is found.

#### **Step 3: Add New Columns**

- **`add_keywords_column(data_path, keywords_path_1, keywords_path_2, output_path)`**: This is the main function of the script. It loads the combined sequence data (from `combined_output.tsv`), applies the two keyword-matching functions, and adds two new columns:

  - **`toxin_keywords`**: Contains `TRUE` if the sequence matches any toxin-related keywords.
  - **`pfam_ToxinKeywords`**: Contains `TRUE` if the sequence matches any Pfam domain keywords.
- The updated DataFrame with the new columns is saved to **`combined_output_keywords.tsv`**.

---

## **Output Files**

The script generates the following output file:

1. **`combined_output_keywords.tsv`**: The final output file, which includes the original data from **TransDeTox** along with two new columns: `toxin_keywords` and `pfam_ToxinKeywords`.

---

## **Dependencies**

### **Python 3**:
This script requires Python 3 or higher to run.

### **Python Libraries**:

The following Python libraries are required to run the script:
- **pandas**: For data manipulation and reading/writing CSV/TSV files.
- **re**: For regular expression matching to check for whole-word keyword matches.

You can install the necessary libraries by running the following commands:

```
# bash
pip install pandas
```
# How to Run the Script
## Pre-requisites:

  1. **Input Files:** Ensure that the following input files are available in the same directory as the script:
          - combined_output.tsv: Generated from the **TransDeTox** module.
          - toxins_keywords.csv: Contains general toxin-related keywords.
          - ToxProt_domain_Keywords.tsv: Contains Pfam domain keywords associated with toxins.
  2. **Python Environment:** Ensure that Python 3 and the required libraries are installed.

## Running the Script:
    1. Open a terminal and navigate to the directory containing the script and the input files.
    2. Run the script using the following command:

```
# bash
cd path/to/ToxinKeyMatch.py
python3 ToxinKeyMatch.py
```

## Output:

The script will generate the following output file in the same directory:

    - combined_output_keywords.tsv

This file will contain the original sequence data along with the added toxin_keywords and pfam_ToxinKeywords columns.
